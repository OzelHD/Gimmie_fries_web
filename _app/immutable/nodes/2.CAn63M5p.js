import{b as re,d as Te,t as N,a as C}from"../chunks/C4Y5TuMq.js";import{i as Ee}from"../chunks/SFMkiYAL.js";import{s as G,h as E,G as ce,I as Ie,a as ee,b as ue,n as p,J as ve,c as Ae,r as se,d as W,g as H,K as De,e as me,f as ae,p as ke,L as _e,M as Se,N as Q,O as ne,P as Z,Q as oe,R as Ce,S as Pe,T as Me,V as Ne,W as Re,F as he,X as Le,Y as He,Z as ge,_ as Oe,$ as ze,a0 as Fe,a1 as $e,a2 as Be,w as Ye,z as Ve,A as L,C as k,B as P,a3 as F,x as ie,a4 as Ue,y as q}from"../chunks/D6LCdpPV.js";import{e as qe,s as j}from"../chunks/D5R4xv-h.js";import{i as $}from"../chunks/CTUqY4jS.js";function Ge(r,e){return e}function Qe(r,e,a,n){for(var i=[],c=e.length,f=0;f<c;f++)Me(e[f].e,i,!0);var m=c>0&&i.length===0&&a!==null;if(m){var d=a.parentNode;Ne(d),d.append(a),n.clear(),M(r,e[0].prev,e[c-1].next)}Re(i,()=>{for(var _=0;_<c;_++){var s=e[_];m||(n.delete(s.k),M(r,s.prev,s.next)),he(s.e,!m)}})}function Xe(r,e,a,n,i,c=null){var f=r,m={flags:e,items:new Map,first:null};{var d=r;f=E?G(ce(d)):d.appendChild(Ie())}E&&ee();var _=null,s=!1,h=ve(()=>{var o=a();return Se(o)?o:o==null?[]:_e(o)});ue(()=>{var o=p(h),v=o.length;if(s&&v===0)return;s=v===0;let u=!1;if(E){var S=f.data===Ae;S!==(v===0)&&(f=se(),G(f),W(!1),u=!0)}if(E){for(var b=null,t,l=0;l<v;l++){if(H.nodeType===8&&H.data===De){f=H,u=!0,W(!1);break}var x=o[l],y=n(x,l);t=pe(H,m,b,null,x,y,l,i,e,a),m.items.set(y,t),b=t}v>0&&G(se())}E||Je(o,m,f,i,e,n,a),c!==null&&(v===0?_?me(_):_=ae(()=>c(f)):_!==null&&ke(_,()=>{_=null})),u&&W(!0),p(h)}),E&&(f=H)}function Je(r,e,a,n,i,c,f){var m=r.length,d=e.items,_=e.first,s=_,h,o=null,v=[],u=[],S,b,t,l;for(l=0;l<m;l+=1){if(S=r[l],b=c(S,l),t=d.get(b),t===void 0){var x=s?s.e.nodes_start:a;o=pe(x,e,o,o===null?e.first:o.next,S,b,l,n,i,f),d.set(b,o),v=[],u=[],s=o.next;continue}if(Ke(t,S,l),(t.e.f&Z)!==0&&me(t.e),t!==s){if(h!==void 0&&h.has(t)){if(v.length<u.length){var y=u[0],g;o=y.prev;var w=v[0],I=v[v.length-1];for(g=0;g<v.length;g+=1)le(v[g],y,a);for(g=0;g<u.length;g+=1)h.delete(u[g]);M(e,w.prev,I.next),M(e,o,w),M(e,I,y),s=y,o=I,l-=1,v=[],u=[]}else h.delete(t),le(t,s,a),M(e,t.prev,t.next),M(e,t,o===null?e.first:o.next),M(e,o,t),o=t;continue}for(v=[],u=[];s!==null&&s.k!==b;)(s.e.f&Z)===0&&(h??(h=new Set)).add(s),u.push(s),s=s.next;if(s===null)continue;t=s}v.push(t),o=t,s=t.next}if(s!==null||h!==void 0){for(var T=h===void 0?[]:_e(h);s!==null;)(s.e.f&Z)===0&&T.push(s),s=s.next;var R=T.length;if(R>0){var O=m===0?a:null;Qe(e,T,O,d)}}oe.first=e.first&&e.first.e,oe.last=o&&o.e}function Ke(r,e,a,n){Pe(r.v,e),r.i=a}function pe(r,e,a,n,i,c,f,m,d,_){var s=(d&Le)!==0,h=(d&He)===0,o=s?h?Q(i):ne(i):i,v=(d&Ce)===0?f:ne(f),u={i:v,v:o,k:c,a:null,e:null,prev:a,next:n};try{return u.e=ae(()=>m(r,o,v,_),E),u.e.prev=a&&a.e,u.e.next=n&&n.e,a===null?e.first=u:(a.next=u,a.e.next=u.e),n!==null&&(n.prev=u,n.e.prev=u.e),u}finally{}}function le(r,e,a){for(var n=r.next?r.next.e.nodes_start:a,i=e?e.e.nodes_start:a,c=r.e.nodes_start;c!==n;){var f=ge(c);i.before(c),c=f}}function M(r,e,a){e===null?r.first=a:(e.next=a,e.e.next=a&&a.e),a!==null&&(a.prev=e,a.e.prev=e&&e.e)}function fe(r,e,a,n,i){var c=r,f="",m;ue(()=>{if(f===(f=e()??"")){E&&ee();return}m!==void 0&&(he(m),m=void 0),f!==""&&(m=ae(()=>{if(E){H.data;for(var d=ee(),_=d;d!==null&&(d.nodeType!==8||d.data!=="");)_=d,d=ge(d);if(d===null)throw Oe(),ze;re(H,_),c=G(d);return}var s=f+"",h=Te(s);re(ce(h),h.lastChild),c.before(h)}))})}const We=Symbol("is custom element"),Ze=Symbol("is html");function je(r,e,a,n){var i=ea(r);if(E){i[e]=r.getAttribute(e);return}i[e]!==(i[e]=a)&&(a==null?r.removeAttribute(e):typeof a!="string"&&aa(r).includes(e)?r[e]=a:r.setAttribute(e,a))}function ea(r){return r.__attributes??(r.__attributes={[We]:r.nodeName.includes("-"),[Ze]:r.namespaceURI===Fe})}var de=new Map;function aa(r){var e=de.get(r.nodeName);if(e)return e;de.set(r.nodeName,e=[]);for(var a,n=r,i=Element.prototype;i!==n;){a=Be(n);for(var c in a)a[c].set&&e.push(c);n=$e(n)}return e}var ta=N('<p class="mt-6 text-xl text-gray-600">Suche nach <strong class="text-yellow-500 font-bold">Pommes</strong>...</p>'),ra=N('<p class="mt-6 text-xl text-red-600"> </p> <h2 class="mt-6 text-2xl font-semibold">üçü Error...</h2>',1),sa=N('<div class="text-sm text-gray-800 mt-2"> </div>'),na=N('<img alt="Bild" class="mt-3 rounded-md w-full max-h-60 object-cover">'),oa=N('<li class="bg-white shadow-md rounded-lg p-4 text-left"><div class="font-bold text-lg"> </div> <div class="text-md font-semibold text-gray-800 mt-1"><!></div> <div class="text-gray-600 text-sm mt-1"><!></div> <!> <!></li>'),ia=N('<h2 class="mt-6 text-2xl font-semibold">üçü Gefunden in diesen Mensas:</h2> <ul class="mt-4 space-y-6 w-full max-w-xl"></ul>',1),la=N('<h2 class="mt-6 text-2xl font-semibold">üçü nix <strong class="text-yellow-500 font-bold">Pommes</strong> gefunden... üçü</h2>'),fa=N('<main class="flex flex-col items-center justify-center min-h-screen p-4 bg-gray-50 text-center"><button class="text-6xl p-6 rounded-full shadow-xl bg-yellow-300 hover:bg-yellow-400 active:bg-yellow-500 transition-all">üçü</button> <!> <!> <!> <!></main>');function _a(r,e){Ye(e,!1);let a=Q(!1),n=Q([]),i=Q(null);function c(t){return t.replace(/(pommes)/gi,'<strong class="text-yellow-500 font-bold">$1</strong>')}async function f(){var l,x,y,g;console.log("üçü Pommes Fetch Triggered!"),F(a,!0),F(i,null),F(n,[]);const t={3:"Clausius-Bar",5:"Dozentenfoyer",7:"Food&Lab",8:"Archimedes",9:"Polyterasse",10:"Polysnack",11:"Tannenbar",14:"Alumni quattro Lounge",16:"Bistro HPI",17:"food market - green day",18:"food market - grill bbQ",19:"food market - pizza pasta day",20:"Fusion meal",21:"Octavo",23:"Dozentenfoyer 2"};try{const w=new Date,I=w.getDay(),T=new Date(w);T.setDate(w.getDate()-(I+6)%7);const R=T.toISOString().split("T")[0],O=new Date(T);O.setDate(T.getDate()+14);const B=O.toISOString().split("T")[0],V=await(await fetch(`https://idapps.ethz.ch/cookpit-pub-services/v1/weeklyrotas?client-id=ethz-wcms&lang=de&rs-first=0&rs-size=50&valid-after=${R}&valid-before=${B}`)).json(),X=w.getDay()===0?7:w.getDay(),U=[];for(const Y of V["weekly-rota-array"]||[]){const A=t[Y["facility-id"]]||`Mensa-ID ${Y["facility-id"]}`;for(const D of Y["day-of-week-array"]||[])if(D["day-of-week-code"]===X)for(const J of D["opening-hour-array"]||[])for(const K of J["meal-time-array"]||[])for(const ye of K["line-array"]||[]){const z=ye.meal||{},xe=((l=z.name)==null?void 0:l.toLowerCase())||"",we=((x=z.description)==null?void 0:x.toLowerCase())||"",be=z["image-url"]||null;(xe.includes("pommes")||we.includes("pommes"))&&U.push({mensa:A,name:z.name||"",description:z.description||"",studentPrice:((g=(y=z["meal-price-array"])==null?void 0:y[0])==null?void 0:g.price)||null,image:be})}}F(n,U)}catch{F(i,"Verbindung fehlgeschlagen")}finally{F(a,!1)}}Ee();var m=fa(),d=L(m),_=k(d,2);{var s=t=>{var l=ta();C(t,l)};$(_,t=>{p(a)&&t(s)})}var h=k(_,2);{var o=t=>{var l=ra(),x=ie(l),y=L(x,!0);P(x),Ue(2),q(()=>j(y,p(i))),C(t,l)};$(h,t=>{p(i)&&t(o)})}var v=k(h,2);{var u=t=>{var l=ia(),x=k(ie(l),2);Xe(x,5,()=>p(n),Ge,(y,g)=>{var w=oa(),I=L(w),T=L(I,!0);P(I);var R=k(I,2),O=L(R);fe(O,()=>c(p(g).name)),P(R);var B=k(R,2),te=L(B);fe(te,()=>c(p(g).description)),P(B);var V=k(B,2);{var X=A=>{var D=sa(),J=L(D);P(D),q(K=>j(J,`üí∞ Preis (Studierende): CHF ${K??""}`),[()=>p(g).studentPrice.toFixed(2)],ve),C(A,D)};$(V,A=>{p(g).studentPrice!==null&&A(X)})}var U=k(V,2);{var Y=A=>{var D=na();q(()=>je(D,"src",p(g).image)),C(A,D)};$(U,A=>{p(g).image&&A(Y)})}P(w),q(()=>j(T,p(g).mensa)),C(y,w)}),P(x),C(t,l)};$(v,t=>{p(n).length&&t(u)})}var S=k(v,2);{var b=t=>{var l=la();C(t,l)};$(S,t=>{!p(a)&&!p(i)&&p(n).length===0&&t(b)})}P(m),qe("click",d,f),C(r,m),Ve()}export{_a as component};
